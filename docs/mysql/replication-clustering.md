---
sidebar_position: 7
---

# 복제 및 클러스터링

---

## **🔑 핵심 요약**

- **복제(Replication)**: 데이터베이스의 동일 데이터를 여러 서버에 복사하여 가용성 및 성능을 향상시키는 기법.
- **클러스터링(Clustering)**: 여러 서버가 하나의 논리적인 서버처럼 동작하도록 구성하여 가용성 및 확장성을 개선하는 기법.
- **마스터-슬레이브 복제**: 한 서버에서 데이터를 수정하면, 복제된 서버(슬레이브)로 데이터를 복사하는 구조.
- **마스터-마스터 복제**: 두 개 이상의 서버가 서로 데이터를 복제하는 구조.
- **MySQL Cluster**: 고가용성, 분산 처리 시스템을 제공하는 MySQL 클러스터링 기술.

---

## **🔹 1. MySQL 복제(Replication)**

### **1.1 복제란?**

- **정의**: 하나의 MySQL 서버에서 데이터를 변경하면, 그 변경 내용이 자동으로 다른 서버로 복제되는 시스템.
- **목적**: 데이터 가용성 증가, 로드 분산, 백업 및 장애 복구.

### **1.2 복제의 종류**

- **마스터-슬레이브 복제 (Master-Slave Replication)**:
    - **설명**: 마스터 서버에서 발생한 모든 변화가 슬레이브 서버에 복제됨.
    - **장점**: 읽기 성능 향상, 장애 대비.
    - **단점**: 쓰기 성능이 마스터 서버에 집중됨.
- **마스터-마스터 복제 (Master-Master Replication)**:
    - **설명**: 두 개 이상의 서버가 서로 데이터를 복제하는 구조. 각 서버가 마스터 역할을 함.
    - **장점**: 두 서버 모두 읽기/쓰기가 가능.
    - **단점**: 충돌 해결 및 데이터 일관성 유지가 어려울 수 있음.
- **다중 슬레이브 복제**:
    - **설명**: 하나의 마스터 서버에서 다수의 슬레이브 서버로 복제.
    - **장점**: 부하 분산, 고가용성.

### **1.3 복제 구성 요소**

- **마스터 서버(Master)**: 데이터를 수정하는 주 서버.
- **슬레이브 서버(Slave)**: 마스터 서버의 데이터를 복제하는 서버.

---

## **🔹 2. MySQL 복제 설정**

### **2.1 마스터-슬레이브 복제 설정**

1. **마스터 서버 설정**:
    - **`my.cnf` 수정**:
        
        ```
        [mysqld]
        server-id=1
        log-bin=mysql-bin
        ```
        
    - **사용자 생성**: 슬레이브가 복제할 수 있도록 권한 부여.
        
        ```sql
        CREATE USER 'replica'@'%' IDENTIFIED BY 'password';
        GRANT REPLICATION SLAVE ON *.* TO 'replica'@'%';
        ```
        
2. **슬레이브 서버 설정**:
    - **`my.cnf` 수정**:
        
        ```
        [mysqld]
        server-id=2
        ```
        
    - **슬레이브 연결**:
        
        ```sql
        CHANGE MASTER TO
        MASTER_HOST='master_ip',
        MASTER_USER='replica',
        MASTER_PASSWORD='password',
        MASTER_LOG_FILE='mysql-bin.000001',
        MASTER_LOG_POS=  154;
        ```
        
    - **슬레이브 시작**:
        
        ```sql
        START SLAVE;
        ```
        

### **2.2 마스터-마스터 복제 설정**

- **양쪽 서버에서 동일한 설정**:
    - **서버 설정**: 각 서버에 `server-id` 값을 다르게 설정하여 두 서버가 서로 복제하도록 구성.
    - **중요 사항**: 충돌 방지, 데이터 일관성 관리가 필요.

---

## **🔹 3. MySQL 클러스터링(Clustering)**

### **3.1 클러스터링이란?**

- **정의**: 여러 MySQL 서버가 하나의 클러스터로 동작하여 데이터를 분산 처리하고, 고가용성 및 확장성을 제공하는 시스템.
- **목적**: 데이터의 분산 처리, 성능 향상, 장애 대응.

### **3.2 MySQL Cluster 구성**

- **노드(Node)**:
    - **데이터 노드(Data Node)**: 데이터를 실제로 저장하는 노드.
    - **SQL 노드(SQL Node)**: 클러스터와의 인터페이스 역할을 하며, 클라이언트 요청을 처리.
    - **관리 노드(Management Node)**: 클러스터의 상태를 관리하고, 노드를 모니터링.
- **클러스터의 특징**:
    - **데이터 자동 분배**: 데이터를 여러 노드에 분배하여 처리.
    - **자동 복제**: 데이터 노드 간의 데이터 복제.

### **3.3 MySQL Cluster 설정**

1. **클러스터 설정 파일 작성**: 각 노드의 `my.cnf` 파일에 클러스터 설정을 추가.
    
    ```
    [mysqld]
    ndbcluster
    datadir=/var/lib/mysql
    server-id=1
    ```
    
2. **관리 노드 설정**:
    - **관리 노드 설정**: `config.ini` 파일에 클러스터 구성을 설정.
        
        ```
        [ndb_mgmd]
        hostname=192.168.1.1
        datadir=/var/lib/mysql-cluster
        ```
        

---

## **🔹 4. MySQL 복제 및 클러스터링의 비교**

| **기능** | **복제(Replication)** | **클러스터링(Clustering)** |
| --- | --- | --- |
| **구성** | 마스터-슬레이브, 마스터-마스터 | 데이터 노드, SQL 노드, 관리 노드 |
| **목표** | 데이터 가용성 및 성능 향상 | 고가용성, 분산 처리, 확장성 |
| **장점** | 데이터 복제, 로드 분산 | 자동 복제, 데이터 분산 처리, 고가용성 |
| **단점** | 쓰기 성능 집중, 충돌 관리 필요 | 설정 및 유지 관리가 복잡 |

---

## **📌 요약**

- **MySQL 복제**는 데이터를 여러 서버에 복제하여 성능과 가용성을 향상시키는 기술입니다. `마스터-슬레이브 복제`와 `마스터-마스터 복제` 방식으로 구성됩니다.
- **MySQL 클러스터링**은 여러 서버가 하나의 클러스터로 동작하여 분산 처리 및 고가용성을 제공합니다. 데이터를 자동으로 분배하고, 장애 대응이 가능합니다.
- **복제**와 **클러스터링**은 각기 다른 목적과 요구 사항에 맞게 사용됩니다. 복제는 주로 성능 향상과 백업을 위한 것이며, 클러스터링은 고가용성과 확장성에 초점을 맞추고 있습니다.