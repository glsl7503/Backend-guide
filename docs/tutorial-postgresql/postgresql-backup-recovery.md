---
sidebar_position: 6
---

# 백업과 복구

### 💾 **백업 (Backup)**

- **백업**은 데이터베이스의 현재 상태를 저장하여, 이후에 데이터 손실이나 장애 발생 시 복구할 수 있도록 하는 작업.

---

### 🛠️ **백업 방법**

1. **SQL 덤프 (pg_dump)**
    - 데이터베이스를 SQL 형식으로 덤프하여 저장.
    - **장점**: 특정 데이터베이스나 테이블을 선택적으로 백업 가능.
    - **명령어 예시**
        
        ```bash
        pg_dump dbname > dbname_backup.sql
        ```
        
2. **파일 시스템 백업**
    - 데이터베이스가 저장된 디렉터리나 파일을 직접 백업하는 방법.
    - **장점**: 데이터베이스가 커질수록 더 빠른 백업 가능.
    - **단점**: 특정 테이블이나 부분적인 데이터만 복구할 수 없음.
3. **pg_basebackup**
    - 전체 데이터베이스 클러스터를 백업.
    - **장점**: 빠른 백업과 복구가 가능.
    - **명령어 예시**
        
        ```bash
        pg_basebackup -D /path/to/backup -Ft -z -P
        ```
        

---

### ⏳ **백업 주기 설정**

- **정기적인 백업**을 설정하여 데이터를 주기적으로 보호.
    - **일별**: 하루에 한 번 백업.
    - **주별**: 매주 특정 시간에 백업.
    - **특정 이벤트** 후 백업: 주요 변경 사항이 발생할 때마다 백업.

---

### 🔄 **복구 (Restore)**

- **복구**는 백업된 데이터를 사용하여 데이터베이스를 복원하는 작업.

---

### 🛠️ **복구 방법**

1. **SQL 덤프 복구**
    - 백업된 SQL 파일을 실행하여 복구.
    - **명령어 예시**
        
        ```bash
        psql dbname < dbname_backup.sql
        ```
        
2. **파일 시스템 복구**
    - 파일 시스템 백업에서 데이터를 복구.
    - **장점**: 빠른 복구 가능.
    - **단점**: 백업 시점 이후의 데이터는 복구 불가능.
3. **pg_restore**
    - `pg_dump`로 덤프한 파일을 복원.
    - **명령어 예시**
        
        ```bash
        pg_restore -d dbname dbname_backup.dump
        ```
        
4. **pg_basebackup 복구**
    - `pg_basebackup`으로 백업한 데이터를 복원.
    - 데이터베이스 서버를 중지하고, 백업된 데이터 파일을 복원 후 재시작.

---

### ⚠️ **백업과 복구 시 주의사항**

- **정기적인 백업**: 시스템 장애나 데이터 손실을 대비해 정기적으로 백업을 수행.
- **백업 검증**: 백업이 정상적으로 수행되었는지 확인하고, 복구 테스트를 주기적으로 실행.
- **백업 위치**: 백업 파일은 안전한 외부 스토리지에 보관하는 것이 좋음.
- **데이터 무결성**: 백업 후 데이터의 무결성을 확인하여 복구 시 데이터 손실을 방지.